<?xml version="1.0" encoding="UTF-8" ?>

<!--
############################################
# Copyright (c) Thorsten Herrmann (TH-555) #
############################################
-->

<PropertyList>

	<path>res/DDRMI.ac</path>

	<!-- Lighting -->
	<animation>
		<name>DDRMI inside illumination</name>
		<type>material</type>
		<object-name>ddrmi_inside</object-name>
		<object-name>ddrmi_pointer_1_vor</object-name>
		<object-name>ddrmi_pointer_1_adf</object-name>
		<object-name>ddrmi_pointer_2_vor</object-name>
		<object-name>ddrmi_pointer_2_adf</object-name>
		<object-name>ddrmi_vor_adf_flag_1</object-name>
		<object-name>ddrmi_vor_adf_flag_2</object-name>
		<object-name>ddrmi_hdg</object-name>
		<condition>
			<or>
				<greater-than-equals>
					<property>systems/electrical/bus/dcbat</property>
					<value>25</value>
				</greater-than-equals>
				<greater-than-equals>
					<property>systems/electrical/bus/dc1</property>
					<value>25</value>
				</greater-than-equals>
				<greater-than-equals>
					<property>systems/electrical/bus/dc2</property>
					<value>25</value>
				</greater-than-equals>
			</or>
		</condition>
		<emission>
			<red>0.50</red>
			<green>0.35</green>
			<blue>0.2</blue>
			<!--factor-prop>controls/lighting/instruments-norm</factor-prop-->
			<!--factor-prop>controls/lighting/main-panel-norm</factor-prop-->
		</emission>
	</animation>

	<!-- heading and pointer -->
	<animation>
		<name>Heading rotate</name>
		<type>rotate</type>
		<object-name>ddrmi_hdg</object-name>
		<property>orientation/heading-magnetic-deg</property>
		<axis>
			<object-name>ddrmi_hdg.axis</object-name>
		</axis>
	</animation>

	<animation>
		<name>VOR1 select</name>
		<type>select</type>
		<object-name>ddrmi_pointer_1_vor</object-name>
		<condition>
			<equals>
				<property>instrumentation/efis/input/vor-adf-1</property>
				<value>0</value>
			</equals>
		</condition>
	</animation>
	<animation>
		<name>VOR1 rotate</name>
		<object-name>ddrmi_pointer_1_vor</object-name>
		<type>rotate</type>
		<property>instrumentation/nav[0]/heading-deg</property>
		<axis>
			<object-name>ddrmi_hdg.axis</object-name>
		</axis>
	</animation>

	<animation>
		<name>ADF1 select</name>
		<type>select</type>
		<object-name>ddrmi_pointer_1_adf</object-name>
		<condition>
			<greater-than-equals>
				<property>instrumentation/efis/input/vor-adf-1</property>
				<value>1</value>
			</greater-than-equals>
		</condition>
	</animation>
	<animation>
		<name>ADF1 rotate</name>
		<object-name>ddrmi_pointer_1_adf</object-name>
		<type>rotate</type>
		<property>instrumentation/adf[0]/indicated-bearing-deg</property>
		<axis>
			<object-name>ddrmi_hdg.axis</object-name>
		</axis>
	</animation>

	<animation>
		<name>VOR2 select</name>
		<type>select</type>
		<object-name>ddrmi_pointer_2_vor</object-name>
		<condition>
			<equals>
				<property>instrumentation/efis/input/vor-adf-2</property>
				<value>0</value>
			</equals>
		</condition>
	</animation>
	<animation>
		<name>VOR2 rotate</name>
		<object-name>ddrmi_pointer_2_vor</object-name>
		<type>rotate</type>
		<property>instrumentation/nav[1]/heading-deg</property>
		<axis>
			<object-name>ddrmi_hdg.axis</object-name>
		</axis>
	</animation>

	<animation>
		<name>ADF2 select</name>
		<type>select</type>
		<object-name>ddrmi_pointer_2_adf</object-name>
		<condition>
			<greater-than-equals>
				<property>instrumentation/efis/input/vor-adf-2</property>
				<value>1</value>
			</greater-than-equals>
		</condition>
	</animation>
	<animation>
		<name>ADF2 rotate</name>
		<object-name>ddrmi_pointer_2_adf</object-name>
		<type>rotate</type>
		<property>instrumentation/adf[1]/indicated-bearing-deg</property>
		<axis>
			<object-name>ddrmi_hdg.axis</object-name>
		</axis>
	</animation>

	<!-- Knobs -->
	<!-- Todo: implementation the "pick" currently link from the efis switches -->
	<animation>
		<name>Knob 1 rotate</name>
		<object-name>ddrmi_vor_adf_select_1</object-name>
		<type>rotate</type>
		<property>instrumentation/efis/input/vor-adf-1</property>
		<interpolation>
			<entry><ind>0</ind><dep>0</dep></entry>
			<entry><ind>2</ind><dep>45</dep></entry>
			<entry><ind>1</ind><dep>90</dep></entry>
		</interpolation>
		<axis>
			<object-name>ddrmi_vor_adf_select_1.axis</object-name>
		</axis>
	</animation>

	<animation>
		<name>Knob 2 rotate</name>
		<object-name>ddrmi_vor_adf_select_2</object-name>
		<type>rotate</type>
		<property>instrumentation/efis/input/vor-adf-2</property>
		<interpolation>
			<entry><ind>0</ind><dep>0</dep></entry>
			<entry><ind>2</ind><dep>-45</dep></entry>
			<entry><ind>1</ind><dep>-90</dep></entry>
		</interpolation>
		<axis>
			<object-name>ddrmi_vor_adf_select_2.axis</object-name>
		</axis>
	</animation>

	<!-- Flags -->
	<animation>
		<name>Flag  1 visibility</name>
		<type>select</type>
		<object-name>ddrmi_vor_adf_flag_1</object-name>
		<condition>
			<or>
				<!-- Shown if: power supply fails -->
				<and>
					<less-than>
						<property>systems/electrical/bus/dcbat</property>
						<value>25</value>
					</less-than>
					<less-than>
						<property>systems/electrical/bus/dc1</property>
						<value>25</value>
					</less-than>
					<less-than>
						<property>systems/electrical/bus/dc2</property>
						<value>25</value>
					</less-than>
				</and>
				<!-- not VOR and not ADF selected -->
				<equals>
					<property>instrumentation/efis/input/vor-adf-1</property>
					<value>2</value>
				</equals>
				<!-- Todo: Shown if: VOR or ADF receiver fails, RMI internal failure, ADIRS heading signal not valid -->
			</or>
		</condition>
	</animation>

	<animation>
		<name>Flag 2 visibility</name>
		<type>select</type>
		<object-name>ddrmi_vor_adf_flag_2</object-name>
		<condition>
			<or>
				<!-- Shown if: power supply fails -->
				<and>
					<less-than>
						<property>systems/electrical/bus/dcbat</property>
						<value>25</value>
					</less-than>
					<less-than>
						<property>systems/electrical/bus/dc1</property>
						<value>25</value>
					</less-than>
					<less-than>
						<property>systems/electrical/bus/dc2</property>
						<value>25</value>
					</less-than>
				</and>
				<!-- not VOR and not ADF selected -->
				<equals>
					<property>instrumentation/efis/input/vor-adf-2</property>
					<value>2</value>
				</equals>
			</or>
		</condition>
	</animation>

</PropertyList>

